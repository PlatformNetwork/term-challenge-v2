#!/bin/bash
set -e

# Skip hooks if SKIP_GIT_HOOKS=1
if [ "${SKIP_GIT_HOOKS:-0}" = "1" ]; then
    echo "Skipping pre-commit hooks (SKIP_GIT_HOOKS=1)"
    exit 0
fi

# Source cargo environment
if [ -f "$HOME/.cargo/env" ]; then
    source "$HOME/.cargo/env"
fi

echo "Running pre-commit checks..."

# Format code
echo "Formatting code..."
cargo fmt --all

# Add formatted files back to staging
git add -u

echo "Pre-commit checks passed!"
